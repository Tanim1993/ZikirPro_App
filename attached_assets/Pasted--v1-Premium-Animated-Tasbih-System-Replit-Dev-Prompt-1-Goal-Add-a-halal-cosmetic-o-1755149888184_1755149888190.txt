# (v1) Premium Animated Tasbih System â€” Replit Dev Prompt

## 1) Goal

Add a **halal, cosmetic-only** premium tasbih system. Every room shows a **Tasbih Type** with a **â€œChange Tasbihâ€** button. Tapping it opens a **Premium Tasbih Gallery** showing animated tasbih styles with **gold coin** prices. If user lacks coins, show **â€œPurchase Gold Coinsâ€** (no gambling/loot-boxes; direct purchase only).

---

## 2) Tasbih Packs (10 animated styles)

Each has: `id`, `name`, `animation`, `rarity`, `priceCoins`, `previewLottie/mp4`, `thumbnail`.

1. `classic_wood` â€” Polished walnut beads, subtle shine on tap â€” **Common** â€” 200
2. `emerald_glow` â€” Deep green beads, soft radial glow on increment â€” **Uncommon** â€” 400
3. `noor_pearl` â€” Pearl-white beads, gentle bloom + haptic ping â€” **Uncommon** â€” 400
4. `sands_of_haram` â€” Sand-texture beads, dust-mote shimmer â€” **Rare** â€” 600
5. `sabah_misbah` â€” Amber beads, sunrise sweep on combo taps â€” **Rare** â€” 600
6. `zulfiqar_black` â€” Matte onyx beads, minimal ring ripple â€” **Rare** â€” 800
7. `barakah_gold` â€” Brushed gold beads, halo ring on milestones (33/99) â€” **Epic** â€” 1000
8. `ayatul_noor` â€” Calligraphy micro-etch, light trace follows bead â€” **Epic** â€” 1200
9. `rawdah_garden` â€” Olive green + rose separators, leaf-petal burst â€” **Legendary** â€” 1500
10. `lailatul_qadr` â€” Night-sky beads, star sparkle trail on tap â€” **Legendary** â€” 1800

> All effects **tasteful & low-key**, no music by default; sound/haptics toggles in Settings.

---

## 3) UI/Flows

### A) Room Screen (all rooms)

* `Tasbih Type: <currentName>` + **\[Change Tasbih]** button.
* On press â†’ **Premium Tasbih Gallery** (grid: thumb, name, rarity, price).
* Cards:

  * If **owned** â†’ button **\[Equip]**.
  * If **not owned** â†’ button **\[Buy for X ðŸª™]** + small **\[Preview]**.
* If `wallet.coins < price` â†’ show **inline banner**: â€œNot enough coins.â€ + **\[Purchase Gold Coins]**.

### B) Coins Purchase (Halal)

* Simple, transparent packs (example):

  * 300 ðŸª™ â€” \$1.99
  * 800 ðŸª™ â€” \$4.99
  * 1800 ðŸª™ â€” \$9.99
* **No loot boxes**, **no gambling**, **no randomized rewards**.
* Add **Parental gate** (confirm age) and **Spending limit** toggle in Settings.

### C) Equip Logic

* Equipping a tasbih changes **only the userâ€™s client tasbih** in that room (cosmetic).
* Room detail design stays identical for everyone; others see your equipped skin in leaderboard rows/tap popups.

---

## 4) Copy (strings)

* Buttons: `Change Tasbih`, `Buy for {X} ðŸª™`, `Equip`, `Preview`, `Purchase Gold Coins`, `Restore Purchases`.
* Banners:

  * Success: â€œMashaAllah â€” **{name}** equipped.â€
  * Insufficient: â€œNot enough coins.â€
  * Purchase: â€œCoins added: {X} ðŸª™.â€
* Halal notice (modal footer): â€œCosmetic only. No chance-based rewards.â€

---

## 5) Data Model (additions)

```json
User { id, wallet: { coins:int, updatedAt }, inventory: [tasbihSkinId...] }

TasbihSkin {
  id, name, rarity:"common|uncommon|rare|epic|legendary",
  priceCoins:int, previewUrl, thumbUrl, status:"active|retired"
}

UserPurchase {
  id, userId, type:"coins|skin",
  sku:"coins_300"|"coins_800"|..., coinsDelta:int,
  amountCurrency:"USD", amountCents:int, provider:"Play|AppStore|Stripe",
  createdAt
}

RoomSetting { roomId, defaultTasbihSkinId }  // optional; user override wins

UserRoomConfig { roomId, userId, equippedTasbihSkinId } // current equip per room
```

---

## 6) APIs / Security

* `GET /store/tasbih-skins` â†’ list active skins.
* `POST /store/buy-skin` `{skinId}` â†’ checks `wallet.coins >= price`, **server-side** owns + deducts, writes inventory atomically.
* `POST /wallet/buy-coins` `{sku}` â†’ verify receipt (AppStore/Play/Stripe webhook) â†’ credit coins.
* `POST /room/{id}/equip` `{skinId}` â†’ checks ownership â†’ set `UserRoomConfig`.
* `GET /user/inventory` â†’ owned skin ids + coins.

**Rules:** all mutations **server-authoritative**; no client coin math. Rate limit purchase & equip endpoints. Audit logs.

---

## 7) Store Config (seed example)

```json
[
  {"id":"classic_wood","priceCoins":200,"rarity":"common"},
  {"id":"emerald_glow","priceCoins":400,"rarity":"uncommon"},
  {"id":"noor_pearl","priceCoins":400,"rarity":"uncommon"},
  {"id":"sands_of_haram","priceCoins":600,"rarity":"rare"},
  {"id":"sabah_misbah","priceCoins":600,"rarity":"rare"},
  {"id":"zulfiqar_black","priceCoins":800,"rarity":"rare"},
  {"id":"barakah_gold","priceCoins":1000,"rarity":"epic"},
  {"id":"ayatul_noor","priceCoins":1200,"rarity":"epic"},
  {"id":"rawdah_garden","priceCoins":1500,"rarity":"legendary"},
  {"id":"lailatul_qadr","priceCoins":1800,"rarity":"legendary"}
]
```

---

## 8) Animation/Asset Specs

* **Format:** Lottie JSON preferred (fallback MP4/WebM, <2â€“3MB).
* **States:** idle (loop), tap (150â€“280ms), milestone burst (33/66/99).
* **Performance:** 60fps target; memory-safe for mid-range Android.
* **Accessibility:** color-contrast OK; motion-reduced mode (fade instead of burst).

---

## 9) Halal Compliance

* No jackpots, no spins, no random odds.
* Clear pricing, refunds via store policy.
* Daily limit control, purchase history, â€œDisable purchasesâ€ toggle.
* Cosmetic-only; **no pay-to-win** on counts/leaderboard.

---

## 10) Telemetry & QA

Events (with `roomId`, `skinId`, `coinsBefore/After`):

* `store_opened`, `preview_viewed`, `skin_purchased`, `skin_equipped`, `coins_pack_viewed`, `coins_purchased`, `purchase_failed`, `insufficient_coins_shown`.
  QA checklist: purchase â†’ inventory â†’ equip â†’ persist across app restarts and devices; receipt replay protection.

---

## 11) Definition of Done

* Gallery renders 10 skins with previews & prices.
* Buying coins updates wallet; buying skin deducts coins and adds to inventory (server-side).
* Equip persists per room; others see your equipped skin.
* No randomized mechanics; parental/spend controls present.
* All writes audited; basic rate limits in place.

> If you want, I can also generate **seed JSON** + placeholder Lottie file names and a **minimal Flutter UI stub** for the gallery/equip flow.
